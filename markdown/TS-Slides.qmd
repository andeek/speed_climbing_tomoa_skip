---
title: "The Fast and the Furious:"
subtitle: "Tracking the Effect of the Tomoa Skip on Speed Climbing"
author: ["Caleb Chou", "Andee Kaplan"]
format: revealjs
date: "June 30 2023"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)

## load required libraries and data
library(ggplot2)
library(dplyr)
library(tidyr)
library(cowplot)
library(knitr)

load("./../data/mTimes_skip.Rdata")
load("./../data/wTimes_skip.Rdata")
```

## Background {.center}

```{css}
.center h2 {
  text-align: center;
}
```

## Background

-   IFSC hosts climbing competitions around the globe
-   Three disciplines of climbing: Sport, Bouldering, and Speed
-   Announcement of rock climbing in the 2020 Olympics caused controversy

![](./imgs/sport-climbing.jpeg){style="padding-left: 5%; margin: 0; display: inline-block; padding-bottom: 10%;" width="470"} ![](./imgs/bouldering.webp){#bouldering style="padding-left: 5%; margin: 0; display: inline-block; padding-bottom: 10%;" width="429"}

## Speed Climbing

-   Head to head races, climbers are continuously eliminated until final round
-   Same route every time

![](./imgs/speed_climbing.jpeg){fig-align="center" #speed-climbing style="margin: 0; display: inline-block; padding-bottom: 9%;" width="456"}

## Tomoa Skip

-   Introduced in 2018 by boulderer Tomoa Narasaki
-   A new way to start the route
-   Groundbreaking in that it introduced a bouldering style to speed climbing

{{< video https://www.youtube.com/embed/wTcZWdzGYD4?start=172 width="500" height="350">}}

## Data {.center}

```{css}
.center h2 {
  text-align: center;
}
```

## Data Available

-   IFSC event results can be scraped
-   IFSC final videos used to determine who uses Tomoa Skip
-   Developed script to indicate whether a climber used the Tomoa Skip or not (if data not available)

![](./imgs/IFSC-events.png){#IFSC-events fig-align="center" width="772"}

## Analysis {.center}

```{css}
.center h2 {
  text-align: center;
}
```

## Users of Tomoa Skip Over Time {.center}

```{r message = FALSE, out.width="105%", warning = FALSE, fig.align='center'}
#Label Names:
label_names <- c('F' = 'Womens', 'M' = 'Mens')

# Number of tomoa skip users per start date
m_times_update |>
  bind_rows(w_times_update) |>
  group_by(sex, start_date) |>
  filter(!is.na(tomoa_skip)) |>
  summarise(num_ts = sum(tomoa_skip), num_no_ts = sum(!tomoa_skip)) |>
  ggplot() +
  geom_point(aes(start_date, num_ts, color = "Tomoa Skip")) + 
  geom_point(aes(start_date, num_no_ts, color = "No Tomoa Skip")) + 
  geom_smooth(aes(start_date, num_ts, color = "Tomoa Skip"), method = "auto") +
  geom_smooth(aes(start_date, num_no_ts, color = "No Tomoa Skip"), method = "auto") +
  facet_wrap(.~sex, labeller = as_labeller(label_names)) +
  labs(x="Start Date", y = "Count") + 
  theme(legend.title = element_blank())

```

::: notes
-   After introduction of TS in 2018, TS is rapidly adopted
-   Use of non-TS beta plumets and TS becomes the norm
:::

## Best Final vs Best Qualifier Times {.center}

```{r warning = FALSE, out.width = "100%", message = FALSE}

#Best Final and Best Qualifier
label_names <- c('FALSE' = "No Tomoa Skip", 'TRUE' = "Tomoa Skip")
m_times_update |>
  # These pivot_longers are producing duplicates
  filter(rank <= 16) |>
  pivot_longer(cols = c("best_qual", "lane_a", "lane_b"), names_to = "qual_round", values_to = "qual_time") |>
  pivot_longer(cols = c("final", "first_round", "quarter", "semi", "small_final", "big_final"), names_to = "final_round", values_to = "final_time") |>
  group_by(fname, lname, sex, event_id, tomoa_skip) |>
  summarise(
    best_qual = ifelse(all(is.na(qual_time)), NA, min(qual_time, na.rm = TRUE)),    
    best_final = ifelse(all(is.na(final_time)), NA, min(final_time, na.rm = TRUE))
  ) |>
  filter(!is.na(best_qual) & !is.na(best_final)) |>
  ggplot() +
  geom_jitter(aes(best_qual, best_final, color = tomoa_skip), alpha=0.7, show.legend = FALSE) + 
  geom_abline() +
  facet_wrap(.~tomoa_skip, labeller = as_labeller(label_names)) + 
  labs(x = "Best Qualifier Time", y = "Best Final Time") + 
  coord_cartesian(ylim = c(0, 30), xlim = c(0, 30)) + 
  scale_colour_discrete(name  ="",
                        breaks=c(TRUE, FALSE),
                        labels=c("Tomoa Skip", "No Tomoa Skip"))


```

::: notes
-   Not as linear as expected
-   Many Climbers do better in qual than final:
-   Less stress
-   Multiple attempts
-   One fall or FS in final disqualifies
:::

## Falls Rates In Finals By Year {.center}

```{css}
#| echo: false

.reveal table {
  font-size: 1.4rem;
  margin: 0;
  padding: 0;
}

```

```{r message = FALSE, warning = FALSE}
# Fall rate in final by year table
fall_rate_table <- m_times_update |> 
  filter(rank <= 16) |> 
  group_by(year) |> 
  summarise(
    num_falls_final_no_ts = sum(!tomoa_skip & fall_final, na.rm = TRUE), 
    num_falls_final_ts = sum(tomoa_skip & fall_final, na.rm = TRUE), 
    num_events = length(unique(event_id))
  ) |> 
   mutate(fall_rate_no_ts = round(num_falls_final_no_ts / num_events, 3),
          fall_rate_ts = round(num_falls_final_ts / num_events, 3))


knitr::kable(
  fall_rate_table,
  col.names = c('Year', 'Final Falls (No TS)', 'Final Falls (TS)', 'Number of Events', 'Fall Rate (No TS)', 'Fall Rate (TS)')
)
```

## Next Steps

-   Modeling:
    -   Does Tomoa Skip have a statistically signifigant effect on times?
    -   Are climbers statistically slower in finals?
-   Woman's data
-   More data
